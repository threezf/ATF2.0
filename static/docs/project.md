# 测试项目的建立与管理
&#8195;&#8195;&#8194;ATF 自动化测试项目中将测试流程分解为一个个的测试项目。每个测试项目都包含多个测试用例、测试脚本等数据。测试工作也是从某个测试项目开始的。 <br>
&#8195;&#8195;&#8194;测试项目管理系统包含的功能有添加测试项目、修改测试项目、管理功能点、对测试项目的批量查询和模糊查询，其界面如图1所示：
<center>

![](/static/img/project/1.png)
图1 测试项目的新建与管理
</center>
 
&#8195;&#8195;&#8194;点击页面上方的添加按钮，就可以建立一个新的测试项目。如图2所示，需要在测试项目名称输入框填写该项目的语义化名称，项目名称要能体现进行该项目的目的或者目标。测试项目编号一般用一串数字来表示，比如与日期相关的编号，或者与系统相关联的编号。描述用来详细的描述该项目，包括项目的发起人，要测试的系统、功能点，以及该项目的执行时间等，项目时间一般用来声明该项目的开始与结束时间。
<center>

![](/static/img/project/2.png)
图2 新建测试项目
</center>
&#8195;&#8195;&#8194;已存在的测试项目也可以进行修改操作。为了方便查找测试项目，ATF测试项目提供了按条件检索相应的测试项目的功能。我们可以根据测试项目名称查找符合要求的项目。在输入框中输入要查找的关键字，可以是项目名称或者项目编号，系统就会筛选出符合条件的测试项目。如图3所示，本系统中使用的是模糊查询的方法，也就是只要包含了关键字的测试项目，都可以被查找出来。
<center>

![](/static/img/project/3.png)
图3 测试项目查询 
</center>

## 测试用例管理
### 添加用例
&#8195;&#8195;&#8194;点击功能按钮组的添加按钮，打开添加用例的模态框，可以选择添加单用例和流程用例，配置用例名称、所属被测系统、功能点、基础脚本、用例性质等信息可以完成用例的添加，图4展示的是单用例的添加，图5展示的是流程用例的添加，流程用例配置时可以为流程用例添加多个流程节点。
<center>

![](/static/img/project/4.png)
图4 添加单用例
</center>
<center>

![](/static/img/project/5.png)
图5 添加流程用例
</center>

### 查看和修改用例详情
&#8195;&#8195;&#8194;如图6所示，点击表格指定行的查看按钮，会弹出用例详情模态框，可以查看该用例的详情；如图7所示，点击右侧的“修改”按钮，打开修改模态框，可以修改相应的用例属性，点击“修改”按钮，可对修改操作进行保存。
<center>

![](/static/img/project/6.png)

图6 查看用例详情
</center>
<center>

![](/static/img/project/7.png)<br>
图7 修改用例信息
</center>

### 导入用例
&#8195;&#8195;&#8194;如图8所示，点击“导入”按钮，弹出导入用例模态框，先点击“模板下载”按钮下载用例模板，然后按照模板格式进行编写，编写完成后点击“选择文件”按钮选择本地写好的用例文件，点击“导入”进行上传。
<center>

![](/static/img/project/8.png)

图8 导入模板用例
</center>

### 导入记录
&#8195;&#8195;&#8194;如图9所示，点击“导入记录”按钮，进入导入记录页面，可以查看用例的全部导入记录，可以根据上传者、导入状态、导入时间进行条件筛选。点击上方的“导入”按钮可以进行用例的导入，点击“返回”按钮可以返回上一级页面。
<center>

![](/static/img/project/9.png)
图9 导入记录
</center>

### 导出用例
&#8195;&#8195;&#8194;如图10所示，先在表格中选中想要导出的用例，点击页面上方的“导出”按钮，即可完成用例的导出操作，系统支持单个导出和批量导出。
<center>

![](/static/img/project/10.png)
图10 导出用例
</center>
### 更改多种用例信息
&#8195;&#8195;&#8194;如图11所示，首先在表格中选中需要更改执行方式的用例，然后点击页面上方的“更改多种用例信息”按钮，可以进行被测系统、功能点、基础脚本、用例性质的更改。
<center>

![](/static/img/project/11.png)

图11 更改多种用例信息
</center>

### 添加流程节点
&#8195;&#8195;&#8194;如图12，选中流程用例，可以为流程用例添加流程节点，同流程用例添加时节点的配置。
<center>

![](/static/img/project/12.png)
图12 添加流程节点
</center>

### 删除流程节点
&#8195;&#8195;&#8194;如图13所示，选择指定的流程节点，点击删除功能按钮，即可删除指定的流程节点。

<center>

![](/static/img/project/13.png)
图13 删除流程节点
</center>

### 筛选用例
&#8195;&#8195;&#8194;点击左侧菜单“项目测试” > “测试用例管理”，进入测试用例管理页面，页面如图14所示：
<center>

![](/static/img/project/14.png)
图14 筛选用例
</center>

&#8195;&#8195;&#8194;如图15所示，点击“显示筛选”按钮，展开筛选条件面板，用户可根据实际情况添加多组筛选条件，可以选择被测系统等筛选条件，根据筛选操作与比较值取值的不同进行用例的筛选过滤。
<center>

![](/static/img/project/15.png)
图15 查询用例
</center>
&#8195;&#8195;&#8194;查询完成之后点击“取消筛选”按钮即可收起筛选。

## 测试资源管理
### 测试资源管理简介
&#8195;&#8195;&#8194;如图16所示，编写完测试用例，并且已经准备好测试数据和测试脚本，就可以对测试脚本进行了参数化之后，参数化后就拥有了进行测试的基本资源。这时，为了在测试前将各个资源结合起来，就需要在测试资源管理系统中统一管理这些资源。<br>
&#8195;&#8195;&#8194;测试资源管理中，首先根据条件筛选出所需要的多个项目，然后在给出的项目中选择特定的系统、功能点以及脚本，查看对应的资源列表。<br>
&#8195;&#8195;&#8194;下图是测试资源的筛选项。可以根据用例的属性、所属的系统等各个条件筛选出相应的项目。
<center>

![](/static/img/project/16.png)

图16 测试资源查询
</center>

&#8195;&#8195;&#8194;选择相应的测试项目之后，就可以查看其中的测试资源列表。资源列表中，有以下几个方面：查看脚本、用例编号、所属测试点、测试意图、测试步骤、预期结果。如图17所示：
<center>

![](/static/img/project/17.png)
图17 测试资源管理
</center>

### 测试资源编辑
&#8195;&#8195;&#8194;ATF 项目的测试资源管理列表实现了类似于Excel的功能，可以实现批量的复制、剪切、粘贴功能，可以方便用户进行数据的编辑工作。同时，ATF项目也提供了对脚本内容进行编辑的功能。通过点击可编辑的单元格，实现对单元格内脚本内容的编辑。<br>
&#8195;&#8195;&#8194;在编辑界面中，可以直接编辑脚本的内容，也可以为测试脚本添加前置操作与后置操作。编辑内容的界面如图18所示：
<center>

![](/static/img/project/18.png)
图18 编辑数据项（去除语句）
</center>
 
&#8195;&#8195;&#8194;编辑的数据有四种类型可以选择：文本、空文本、去除语句和表达式。下面逐一介绍四种类型。
- 文本类型：可以在输入框中输入常见的字符串文本。
- 空文本和去除语句：可以使用系统固定的文本填充到数据表格中。
- 选择表达式：可以在表达式中插入数据或者函数。插入数据如图19所示：
<center>

![](/static/img/project/19.png)
图19编辑数据项（表达式）
</center>
&#8195;&#8195;&#8194;如图20所示，数据取自数据池中，有如下几种类型：用例内部变量、流程用例数据、组合用例数据、场景数据、全局数据、环境数据等。点击确定后，就会自动补充在表达式文本框中。下图是插入了一条用例内部变量之后的文本。
<center>

![](/static/img/project/20.png)
图20 插入用例内部变量
</center>
&#8195;&#8195;&#8194;如图21所示，也可以向表达式中插入函数，选择了相应的函数名称，并填写各个参数之后，系统也会向表达式输入框中自动填充相应的内容：
<center>

![](/static/img/project/21.png)
图21 自动填充表达式内容
</center>
&#8195;&#8195;&#8194;还可以通过添加操作项的方式，向表达式中添加前置操作与后置操作。首先，点击编辑框中的“添加多项”按钮，会弹出如下操作框。操作框的上侧是由UI和UI所包含的元素组成的树结构，下侧是在系统配置中所配置的函数集合。如图22所示： 
<center>

![](/static/img/project/22.png)
图22 选择操作项与方法
</center>
&#8195;&#8195;&#8194;如图23所示，选择了要添加的操作项后就会在操作项列表中新增一条记录。我们可以对这条记录进行修改、删除以及拖动排序等等。
<center>

![](/static/img/project/23.png)
图23 前置操作
</center>
&#8195;&#8195;&#8194;完成前置操作、后置操作的配置后，点击确定按钮，系统就会向数据表格中回填相应的内容，如图24所示：
<center>

![](/static/img/project/24.png)
图24 数据回填
</center>

## 测试场景的配置
&#8195;&#8195;&#8194;完成基本的测试资源配置之后，就可以为测试项目添加测试场景，还可以为测试场景添加一些配置。<br>
&#8195;&#8195;&#8194;首先在场景管理页面，选择一个场景进行配置，如图25所示。
<center>

![](/static/img/project/25.png)
图25 选择场景配置
</center>
&#8195;&#8195;&#8194;场景配置的界面如图26所示：
<center>

![](/static/img/project/26.png)
图26 场景配置
</center>
&#8195;&#8195;&#8194;在场景配置界面中，可以进行以下功能：添加用例、移除用例、设置定时执行、管理定时任务、触发器设置、执行过程控制数据资源池配置以及保存顺序等。

### 配置测试用例
&#8195;&#8195;&#8194;如图27所示，可以根据当前测试的需求为场景添加测试用例。点击页面上方的“用例添加”按钮，打开用例选择界面，在该界面选择要添加的测试用例，便可向当前场景中添加测试用例。
<center>

![](/static/img/project/27.png)
图27 添加场景用例
</center>
&#8195;&#8195;&#8194;如图28所示，也可以移除场景中已经存在的用例。
<center>

![](/static/img/project/28.png)

图28 移除用例
</center>

### 设置定时执行
&#8195;&#8195;&#8194;如图29所示，在场景中，可以设置该场景的定时执行。设置了定时执行后，可以指定特定的时间条件下执行测试任务。
<center>

![](/static/img/project/29.png)
图29 设置定时执行
</center>

### 管理定时任务
&#8195;&#8195;&#8194;ATF支持对定时任务进行管理，可以更新、取消以及立刻发起对定时任务的执行，如图30所示。
<center>

![](/static/img/project/30.png)
图30 管理定时任务
</center>

### 触发器设置
&#8195;&#8195;&#8194;在测试场景中，可以通过设置该场景的触发器，指定某些测试用例在符合触发条件时自动执行。<br>
&#8195;&#8195;&#8194;场景中配备了触发器管理系统，可以进行触发器的新增、删除和修改，具体如图31所示。
<center>

![](/static/img/project/31.png)
图31 触发器设置
</center> 
&#8195;&#8195;&#8194;点击“新增”按钮，弹出新增触发器的界面。在编辑页面中，需要填写如下几个方面的数据：触发器名称、描述、执行时机、执行条件、执行动作等，如图32所示。
<center>

![](/static/img/project/32.png)

图32 新增触发器
</center>

触发器名称：表示该触发器在管理系统中的名字。<br>
触发器描述：填写该触发器的详细描述，包括用途、场景、大致的执行条件等内容。<br>
执行时机用来配置触发器在何时被执行。可选项包括如下几种：
1. 场景执行前：在所在的场景执行之前执行。
2. 场景执行后：在所在的场景执行之后执行。
3. 用例执行前：在指定的用例执行之前执行。
4. 用例执行后：在指定的用例执行之后执行。
5. 元素对象方法执行前：在元素对象方法执行之前执行。
6. 元素对象方法执行后：在元素对象方法执行之后执行。<br>
&#8195;执行条件可以实现配置触发器在特定条件下触发执行。有三种条件组合：满足所有条件、满足任一条件和无条件限制。<br>
&#8195;执行动作用来配置触发器执行时所执行的具体的脚本指令。可以指定不止一个动作。
### 执行过程控制
&#8195;如图33所示，测试场景中，可以通过设置该场景执行过程中的策略，来决定在执行过程中的行为。
<center>

![](/static/img/project/33.png)
图33 执行过程控制
</center>

执行策略有如下几个级别：用例级、流程节点级、组合用例级、错误处理模式级。
- 用例级别：可以设置执行状态策略。
- 流程节点级别和组合用例级别：可以设置起始节点策略、执行顺序策略和执行状态策略。
- 错误处理模式：可以设置出错后如何处理。

### 数据资源池配置
&#8195;&#8195;&#8194;测试场景中，可以进行数据资源池配置。如图34所示：
<center>

![](/static/img/project/34.png)
图34 数据资源池配置
</center>
&#8195;&#8195;&#8194;如图35所示，点击新增按钮，可以新增一条数据。
<center>

![](/static/img/project/35.png)

图35 新增数据池
</center>
&#8195;&#8195;&#8194;完成了以上各个项目的设置，就基本完成了测试场景的配置。接下来可以针对该场景执行测试的后续步骤了。

## 测试计划及执行配置
&#8195;&#8195;&#8194;发起测试之前应该对测试计划和执行进行配置。测试计划代表一次完整的测试过程中所包含的所有测试对象和测试流程。每个测试计划包括测试阶段、测试轮次以及包含在该计划中的测试用例，既可以对某个完整的场景进行测试，也可手动添加若干测试用例。具体操作页面见图36。
<center>

![](/static/img/project/36.png)
图36 测试计划及执行页面
</center>
&#8195;&#8195;&#8194;在执行某个测试计划之前，还需要对该执行范围进行配置，执行范围代表本次执行要对计划中的哪些用例进行测试，如图37所示。
<center>

![](/static/img/project/37.png)
图37 测试计划及执行
</center>
&#8195;&#8195;&#8194;点击添加场景可以将之前配置过的测试场景内所有用例打包添加进测试中，在场景列表中可以查看等待测试执行的用例，如图38所示。
<center>

![](/static/img/project/38.png)
图38 新增场景界面
</center>
&#8195;&#8195;&#8194;确定好执行用例后点击批量执行按钮，用例将按照配置好的执行计划在执行机中进行测试。<br>
&#8195;&#8195;&#8194;执行完毕后可以通过点击用例旁边的查看按钮查看执行结果记录， 如图39与图40所示。
<center>

![](/static/img/project/39.png)

图39 节点与执行状态
</center>

<center>

![](/static/img/project/40.png)
图40 执行状态
</center>

### 批次执行查询
用例执行实例的种类分为九种，见表1。
表1 执行实例记录分类表
| 来源编号 | 来源 | 是否入库保存 | 执行类别 | 定位方式|
|----| ---- | ---- | ---- | ---- |
| 1 | 直接加入测试阶段和测试轮次的用例 | 是	| 正式执行和调试 | 测试阶段+测试轮次+用例id |
| 2 | 加入场景后再加入执行阶段和测试轮次的用例 | 是 | 正式执行和调试 | 测试阶段+测试轮次+场景id+用例id|
| 3 | 加入场景的用例 | 是 | 调试 | 场景id+用例id |
| 4 | 用例脚本编写阶段，调试时生成的临时实例 | 否 | 调试执行 | 用例id |
| 5 | 模板脚本编写阶段，调试时生成的临时实例 | 否 | 调试执行 | 模板id+数据名称 |
| 6 | 仅加入测试阶段的用例，作为辅助查询，不能执行或调试 | 是 | 不可执行 | 测试阶段+用例id |
| 7 | 仅加入测试阶段场景，作为辅助查询，不能执行或调试 | 是 | 不可执行 | 测试阶段+场景id+用例id|

&#8195;&#8195;&#8194;入库的执行实例（场景中的执行实例）的执行记录单通过用例执行实例id+执行轮次+执行次数（可选）区分。不入库的临时执行实例（用例脚本调试、模板脚本调试）需要保存记录单，通过来源渠道+用例id+模板id+数据名称+执行轮次+执行次数（可选）区分。
&#8195;&#8195;&#8194;每个用例可以上传多个记录单，当用例有上传的记录单并且没有未解决的问题单时，则执行成功；有未解决的问题单，则执行失败；无记录单且没有未解决的问题单算未执行；流程用例只有部分节点执行成功时算未完成。
批次执行查询具体可以查看以下信息：
1. 发起用户；
2. 用例来源；
3. 测试计划；
4. 执行轮次；
5. 用例总数；
6. 成功用例数；
7. 失败用例数；
8. 跳过用例数；
9. 结果饼状图；
10. 执行状态；
11. 执行结果；
12. 创建时间；
13. 完成时间。

&#8195;&#8195;&#8194;点击批量执行查询即可查看执行结果，如图41所示。
<center>

![](/static/img/project/41.png)
图41 批次执行查询
</center>

## 测试记录单的查看与分析
&#8195;&#8195;&#8194;具体可以查看到以下信息：
1. 场景名称；
2. 执行轮次；
3. 用例编号；
4. 节点名称；
5. 记录单状态；
6. 执行结果状态；
7. 来源渠道；
8. 执行报告。

&#8195;&#8195;&#8194;点击批次执行查询的“查看记录单”按钮可以跳转查看本次执行生成的记录单，如图42所示。
<center>

![](/static/img/project/42.png)
图42 执行记录单
</center>
&#8195;&#8195;&#8194;点击执行报告可以查看执行场景的执行结果，如图43所示。

<center>

![](/static/img/project/43.png)
图43 执行结果
</center>

## 测试结果的统计分析
&#8195;&#8195;&#8194;系统提供了对执行结果记录进行统计的功能。
1. 按执行批次统计：可以统计出同一执行批次内的执行成功数、失败数、跳过数、总数、激活记录单数和未激活记录单数。可以选择其中一项或多项进行统计。
2. 按执行轮次统计：可以统计出同一执行轮次内的执行成功数、失败数、总数。
